@model int

@{
    var YouTubeList = new DataAccess.Repository.YouTubeRepository()
                      .GetAllYouTubes(Model, "BharatTouch/Profile/_youtubeListReadOnly.cshtml")
                      .OrderByDescending(x => x.CreatedDate)
                      .ToList();
}

<style>
    .video-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        justify-content: left;
    }

    .video-item {
        width: 300px;
    }

        .video-item img, .video-item iframe {
            width: 100%;
            height: 250px;
            border-radius: 10px;
            object-fit: cover;
        }

    .video-item {
        cursor: pointer;
        position: relative;
    }
</style>

<div class="video-grid">
    @if (YouTubeList.Count > 0)
    {
        foreach (var YouTube in YouTubeList)
        {
            var youtubeId = "";
            if (!string.IsNullOrEmpty(YouTube.YouTubeUrl))
            {
                var parts = YouTube.YouTubeUrl.Split('/');
                youtubeId = parts.Last();
            }

            <div class="video-item youtube" data-embed="https://www.youtube.com/embed/@youtubeId">
                <img src="https://img.youtube.com/vi/@youtubeId/hqdefault.jpg" loading="lazy" alt="YouTube Video Thumbnail" />
            </div>
        }
    }
    else
    {
        <p>No videos found.</p>
    }
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        var youtube = document.querySelectorAll(".youtube");

        youtube.forEach(function (el) {
            el.addEventListener("click", function () {
                var iframe = document.createElement("iframe");
                iframe.setAttribute("src", el.dataset.embed + "?autoplay=1");
                iframe.setAttribute("frameborder", "0");
                iframe.setAttribute("allow", "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture");
                iframe.setAttribute("allowfullscreen", "");
                iframe.style.width = "100%";
                iframe.style.height = "250px";
                iframe.style.borderRadius = "10px";
                el.innerHTML = "";
                el.appendChild(iframe);
            });
        });
    });
</script>
